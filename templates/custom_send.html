<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Customized Mail</title>
  </head>
  <body class="bg-light">
    <div class="container py-4">
      <h3>Customized Mail Generator</h3>
      <form method="post" action="/custom/send" enctype="multipart/form-data">
        <div class="mb-3">
          <label class="form-label">Upload recipients (Excel/CSV) — optional</label>
          <input class="form-control" type="file" name="file" accept=".csv,.xls,.xlsx">
          <div class="form-text">File should contain an email column and optionally a name column. If provided, names will be used to personalize each message.</div>
        </div>
        <div class="mb-3">
          <label class="form-label">Or enter Recipient Emails (one per line)</label>
          <textarea class="form-control" name="emails" rows="4"></textarea>
        </div>
        <div class="mb-3">
          <label class="form-label">Recipient Name (optional; used if file not provided)</label>
          <input class="form-control" name="name">
        </div>
        <div class="mb-3">
          <label class="form-label">Product (optional)</label>
          <select class="form-select" name="product_key">
            <option value="">None</option>
            {% for key,p in products.items() %}
              <option value="{{ key }}">{{ p.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Description / Context for the email</label>
          <textarea class="form-control" name="description" rows="4" required></textarea>
        </div>
        <!-- Defaults: structure-only formatting (OpenAI) and personalization are applied automatically. -->
        <div class="mb-3">
          <label class="form-label">Subject (optional — if provided, used for all recipients)</label>
          <input class="form-control" name="subject" placeholder="Subject for all recipients (optional)">
        </div>
        <div class="mb-3">
          <label class="form-label">Attachments (images, pdfs) — optional</label>
          <input class="form-control" type="file" name="files" multiple>
        </div>
        <button class="btn btn-primary" type="submit">Generate & Send</button>
        <a class="btn btn-secondary" href="/">Back</a>
      </form>
    </div>
  </body>
</html>
